<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CMNK Staking</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0a2540,#0b3d91);
  color:#fff;
}
.container {
  max-width:420px;
  margin:60px auto;
  padding:24px;
  background:rgba(255,255,255,0.06);
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,0.3);
}
h1{text-align:center;margin-bottom:6px}
.subtitle{text-align:center;font-size:14px;color:#bcd7ff;margin-bottom:20px}
.stat{display:flex;justify-content:space-between;margin:10px 0}
input{width:100%;padding:12px;border-radius:10px;border:none;margin:10px 0;font-size:16px}
button{width:100%;padding:14px;margin-top:10px;border-radius:12px;border:none;font-size:16px;font-weight:bold;cursor:pointer}
.primary{background:#00ccff;color:#002b5c}
.secondary{background:#fff;color:#002b5c}
.danger{background:#ff5c5c;color:#fff}
.footer{text-align:center;font-size:12px;margin-top:18px;color:#bcd7ff}
</style>
</head>

<body>
<div class="container">
<h1>CMNK Staking</h1>
<div class="subtitle">5% APR • No lock time • BNB Chain</div>

<div class="stat">
<span>Your Staked</span>
<strong id="staked">-</strong>
</div>

<div class="stat">
<span>Pending Rewards</span>
<strong id="rewards">-</strong>
</div>

<button id="connectBtn" class="primary">Connect Wallet</button>

<input type="number" id="amount" placeholder="Amount to stake" disabled>

<button id="stakeBtn" class="primary" disabled>Stake</button>
<button id="claimBtn" class="secondary" disabled>Claim Rewards</button>
<button id="unstakeBtn" class="danger" disabled>Unstake</button>

<div class="footer">
Staking contract:<br>
0x07d62b6725f559e4ca7dfc04586c0cf294f58aa9
</div>
</div>

<script>
// ===== CONFIG =====
const stakingAddress = "0x07d62b6725f559e4ca7dfc04586c0cf294f58aa9";
const tokenAddress   = "0xd17c85824eB60d40D332e64B0167E0B4029F49BA";

// ABI
const stakingAbi = [...PASTE ABI HERE IF NOT ALREADY IN FILE...];

// ERC20 ABI
const erc20Abi = [
  "function approve(address spender,uint256 amount) external returns(bool)",
  "function balanceOf(address owner) view returns(uint256)"
];

let provider, signer, staking, token, user;

// ===== CONNECT =====
document.getElementById("connectBtn").onclick = async () => {
  if (!window.ethereum) return alert("Install MetaMask");
  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();
  user = await signer.getAddress();

  staking = new ethers.Contract(stakingAddress, stakingAbi, signer);
  token = new ethers.Contract(tokenAddress, erc20Abi, signer);

  document.getElementById("connectBtn").innerText = "Wallet Connected";
  document.getElementById("amount").disabled = false;
  document.getElementById("stakeBtn").disabled = false;
  document.getElementById("claimBtn").disabled = false;
  document.getElementById("unstakeBtn").disabled = false;

  loadData();
  setInterval(loadData, 15000);
};

// ===== LOAD DATA =====
async function loadData() {
  if (!staking || !user) return;

  const info = await staking.stakes(user);
  const pending = await staking.pendingRewards(user);

  document.getElementById("staked").innerText =
    ethers.utils.formatUnits(info.amount,18);

  document.getElementById("rewards").innerText =
    Number(ethers.utils.formatUnits(pending,18)).toFixed(4);
}

// ===== ACTIONS =====
document.getElementById("stakeBtn").onclick = async () => {
  const value = document.getElementById("amount").value;
  if (value <= 0) return alert("Enter amount");

  const amount = ethers.utils.parseUnits(value,18);
  await token.approve(stakingAddress, amount);
  await staking.stake(amount);
};

document.getElementById("claimBtn").onclick = async () => {
  await staking.claim();
};

document.getElementById("unstakeBtn").onclick = async () => {
  const value = document.getElementById("amount").value;
  if (value <= 0) return alert("Enter amount");

  const amount = ethers.utils.parseUnits(value,18);
  await staking.unstake(amount);
};
</script>
</body>
</html>
